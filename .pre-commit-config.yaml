# Pre-commit hooks configuration for Validated Patterns Toolkit
# See https://pre-commit.com for more information
# See https://pre-commit.com/hooks.html for more hooks

repos:
  # Standard pre-commit hooks
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.5.0
    hooks:
      - id: trailing-whitespace
        name: Trim trailing whitespace
        description: Trims trailing whitespace from files
      - id: end-of-file-fixer
        name: Fix end of files
        description: Ensures files end with a newline
      - id: check-yaml
        name: Check YAML syntax
        description: Validates YAML file syntax
        args: ['--unsafe']  # Allow custom YAML tags used by Ansible
        exclude: '^quarkus-reference-app/charts/.*/templates/.*\.yaml$'  # Exclude Helm templates
      - id: check-added-large-files
        name: Check for large files
        description: Prevents accidentally committing large files
        args: ['--maxkb=1000']
      - id: check-merge-conflict
        name: Check for merge conflicts
        description: Checks for files that contain merge conflict strings
      - id: check-case-conflict
        name: Check for case conflicts
        description: Checks for files with names that would conflict on case-insensitive filesystems
      - id: mixed-line-ending
        name: Check for mixed line endings
        description: Checks for mixed line endings (CRLF/LF)
        args: ['--fix=lf']

  # Gitleaks for secret detection
  - repo: https://github.com/gitleaks/gitleaks
    rev: v8.18.1
    hooks:
      - id: gitleaks
        name: Detect secrets with gitleaks
        description: Scans for secrets and sensitive information
        args: ['protect', '--verbose', '--config=.gitleaks.toml', '--staged']
        stages: [pre-commit]

  # YAML linting (using yamllint)
  - repo: https://github.com/adrienverge/yamllint
    rev: v1.33.0
    hooks:
      - id: yamllint
        name: Lint YAML files
        description: Validates YAML files against style rules
        args: ['-c', '.yamllint']
        types: [yaml]
        exclude: '^quarkus-reference-app/charts/.*/templates/.*\.yaml$'  # Exclude Helm templates

# Global configuration
default_stages: [pre-commit]
fail_fast: false
